# =================
# Navigation/system
# =================
alias ..='cd ..'
alias l='ls -lahF'
alias x='exit'
alias j="z"         # https://github.com/rupa/z
alias o="open"
mkcd() {
  mkdir $@ && cd $_
}

# =================
# Misc
# =================
alias v='nvim'
alias vimconf="nvim ~/.vimrc"
alias y='yarn'

# =================
# Docker/Kubs
# =================
alias d='docker'
alias doc='docker-compose'
alias docup='docker-compose up'
alias docex='docker-compose eec'
alias k='kubectl'

# =================
# Rails
# =================
alias b='bundle'
alias be='bundle exec'
alias r='rails'
alias rs='rails server'
alias rs1='rails server -p 3001'
alias rs2='rails server -p 3002'
alias rs3='rails server -p 3003'
alias rc='rails console'
alias rdm='bundle exec rake db:migrate'
wps() {
  if [ -f ./bin/webpack-dev-server ]; then
    ./bin/webpack-dev-server
  elif [ -f ./script/webpack-dev-server ]; then
    ./script/webpack-dev-server
  else
    npm start
  fi
}

# =================
# Django
# =================
dj() {
  if [ -f ./manage.py ]; then
    python ./manage.py $*
  elif [ -f ./app/manage.py ]; then
    python ./app/manage.py $*
  else
    echo 'manage.py not found'
  fi
}

# =================
# Git
# =================
alias g="git"
alias gs='git s'
alias gd='git d'
alias g-='git checkout -'
alias p='git push'
alias c='git commit -m'
alias pr='~/dotfiles/scripts/git/gh-pull-request.sh'
alias vc='~/dotfiles/scripts/git/gh-view-commit.sh'
alias gclean='~/dotfiles/scripts/git/git-clean-merged.sh'

# =================
# Fun
# =================

# Lookup lyrics of song playing in iTunes
alias ly='~/dotfiles/scripts/lyrics.sh'

# Weather
alias we='curl http://wttr.in/ | less'

# Check playing song on BBC6
alias bbc='~/dotfiles/scripts/bbc6_now_playing.sh'

# =================
# Following needs junegunn/fzf installed.
# =================

# Use fzf with z
unalias z 2> /dev/null
z() {
  [ $# -gt 0 ] && _z "$*" && return
  cd "$(_z -l 2>&1 | fzf-tmux +s --tac --query "$*" | sed 's/^[0-9,.]* *//')"
}

# =================
# Work-related
# =================
kshell() {
  ns=$1
  pod=`kubectl get pods --namespace=$ns | tail -n 1 | awk '{print $1}'`
  kubectl exec -it $pod --namespace=$ns -- python /ueni/app/manage.py shell
}

kbash() {
  ns=$1
  pod=`kubectl get pods --namespace=$ns | tail -n 1 | awk '{print $1}'`
  kubectl exec -it $pod --namespace=$ns -- /bin/bash
}
