# =================
# Navigation/system
# =================
alias ..='cd ..'
alias x='exit'
alias j="z"         # https://github.com/rupa/z
alias o="open"
alias i='ionic'
mkcd() {
  mkdir $@ && cd $_
}

# ====================
# Default replacements
# ====================
alias cat='bat'
alias find='fd'
alias ls="exa"
alias l='ls -lahF'

# ================
# Misc
# =================
alias v='nvim'
alias vconf="nvim ~/.vimrc"
alias y='yarn'

# =================
# Docker / Kubs
# =================
alias d='docker'
alias doc='docker-compose'
alias k='kubectl'

# =================
# Rails
# =================
alias b='bundle'
alias be='bundle exec'
alias r='rails'
alias rs='rails server'
alias rs1='rails server -p 3001'
alias rs2='rails server -p 3002'
alias rs3='rails server -p 3003'
alias rs4='rails server -p 3004'
alias rc='rails console'
alias rdm='bundle exec rake db:migrate'
wps() {
  if [ -f ./bin/webpack-dev-server ]; then
    ./bin/webpack-dev-server
  elif [ -f ./script/webpack-dev-server ]; then
    ./script/webpack-dev-server
  else
    npm start
  fi
}

# =================
# Django
# =================
dj() {
  if [ -f ./manage.py ]; then
    python ./manage.py $*
  elif [ -f ./app/manage.py ]; then
    python ./app/manage.py $*
  else
    echo 'manage.py not found'
  fi
}

# =================
# Git
# =================
alias g="git"
alias gs='git s'
alias gd='git d'
alias g-='git checkout -'
alias p='git push'
alias c='git commit'
alias cm='git commit -m'
alias ca='git commit --amend'

# Special / Scripts
alias pr='~/dotfiles/scripts/git/gh-pull-request.sh'
alias vc='~/dotfiles/scripts/git/gh-view-commit.sh'
alias gclean='~/dotfiles/scripts/git/git-clean-merged.sh'

# =================
# Misc / Fun
# =================

# Lookup lyrics of song playing in iTunes
alias ly='~/dotfiles/scripts/lyrics.sh'

# Weather
alias we='curl http://wttr.in/ | less'

# Check playing song on BBC6
alias bbc='~/dotfiles/scripts/bbc6_now_playing.sh'

# =================
# Following needs junegunn/fzf installed.
# =================

# Use fzf with z
unalias z 2> /dev/null
z() {
  [ $# -gt 0 ] && _z "$*" && return
  cd "$(_z -l 2>&1 | fzf-tmux +s --tac --query "$*" | sed 's/^[0-9,.]* *//')"
}

kp() {
  local pid=$(ps -ef | sed 1d | eval "fzf ${FZF_DEFAULT_OPTS} -m --header='[kill:process]'" | awk '{print $2}')

  if [ "x$pid" != "x" ]
  then
    echo $pid | xargs kill -${1:-9}
  fi
}

top10() {
  print -l ? ${(o)history%% *} | uniq -c | sort -nr | head -n 10
}
